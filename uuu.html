<script>
  const sheetUrl = "https://docs.google.com/spreadsheets/d/1Khc1TfJX-4EyJQOBt6Lw8puCBrfscGfrzle2F0DA4qU/pub?output=csv";

  // تحميل البيانات من Google Sheet
  async function fetchResults() {
    console.log("Fetching data from sheet...");
    const response = await fetch(sheetUrl);
    const data = await response.text();
    console.log("Raw CSV data:", data);

    const rows = data.split("\n").map(r => r.split(","));
    const results = {};

    for (let i = 1; i < rows.length; i++) {
      const row = rows[i];
      if (!row[0]) continue;
      const seatNo = row[0].trim();
      results[seatNo] = {
        name: row[1],
        grade: row[2],
        school: row[3],
        subjects: [
          { name: "اللغة العربية", score: parseInt(row[4])||0, fullScore: 100 },
          { name: "اللغة الإنجليزية", score: parseInt(row[5])||0, fullScore: 100 },
          { name: "الرياضيات", score: parseInt(row[6])||0, fullScore: 100 },
          { name: "العلوم", score: parseInt(row[7])||0, fullScore: 100 },
          { name: "الدراسات الاجتماعية", score: parseInt(row[8])||0, fullScore: 100 }
        ]
      };
    }
    console.log("Parsed results:", results);
    return results;
  }
</script>
